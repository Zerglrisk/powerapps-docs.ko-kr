---
title: PowerApps로 롤업 필드 정의 | Microsoft Docs
description: 롤업 필드를 정의하는 방법 알아보기
ms.custom: ''
ms.date: 05/23/2018
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 (online)
- Dynamics 365 Version 9.x
- powerapps
author: Mattp123
ms.assetid: ff0504a1-01bd-4f9b-b884-7f84911d86c3
caps.latest.revision: 58
ms.author: matp
manager: kvivek
ms.openlocfilehash: c76162747ac2bda27c46895290e5943b7f46739f
ms.sourcegitcommit: aba996b1773ecdf62758e06b34eaf57bede29e08
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/08/2018
ms.locfileid: "39690615"
---
# <a name="define-rollup-fields-that-aggregate-values"></a>값을 집계하는 롤업 필드 정의

롤업 필드는 사용자가 주요 비즈니스 메트릭을 모니터링하여 데이터에 대한 인사이트를 가져오는 데 유용합니다. 롤업 필드에는 지정된 레코드와 관련된 레코드에 대해 계산된 집계 값이 포함되어 있습니다. 여기에는 이메일 및 약속 같은 활동 엔터티와 일반 엔터티가 포함됩니다.

더 복잡한 시나리오에서는 레코드의 계층 구조를 통해 데이터를 집계할 수 있습니다. 관리자 또는 주문 제작자는 코드를 작성할 필요 없이 PowerApps에서 사용자 지정 도구를 사용하여 롤업 필드를 정의할 수 있습니다.  
  
<a name="BKMK_benefitsandcapabilities"></a> 
 
## <a name="rollup-fields-benefits-and-capabilities"></a>롤업 필드의 이점 및 기능 알아보기  

롤업 필드의 이점 및 기능은 다음과 같습니다.  
  
- 시각적 개체 편집은 간단합니다. 일반 필드를 만들 때와 마찬가지로 필드 편집기를 사용하여 롤업 필드를 만들 수 있습니다.  
- 다양한 종류의 집계 함수. `SUM`, `COUNT`, `MIN`, `MAX` 및 `AVG` 함수를 사용하여 데이터를 집계할 수 있습니다.  
- 집계를 위한 완전한 필터 지원. 여러 조건을 설정할 때 원본 엔터티 또는 관련 엔터티에 대한 다양한 필터를 설정할 수 있습니다.  
- 사용자 인터페이스와의 원활한 통합. 양식, 뷰, 차트 및 보고서에 롤업 필드를 포함할 수 있습니다.  
- 롤업 필드는 솔루션 구성 요소입니다. 환경 간에 롤업 필드를 구성 요소로 손쉽게 전송하고 솔루션에 배포할 수 있습니다.  
- 롤업 필드 및 계산된 필드는 서로 보완됩니다. 롤업 필드를 계산된 필드의 일부로 사용하거나 그 반대로 사용할 수 있습니다.  
- 사용자 지정 컨트롤을 사용하도록 롤업 필드를 구성할 수 있습니다.  
  
 롤업 필드의 몇 가지 예는 다음과 같습니다.  
  
- 열린 계정 기회의 총 예상 수익  
- 계층 구조에서 모든 계정 간 열린 기회의 총 예상 수익  
- 자식 기회를 비롯한 기회의 총 예상 수익  
- 캠페인으로 생성된 정규화된 잠재 고객의 총 예상 값  
- 계층 구조의 모든 계정 간에 우선순위가 높은 열린 사례 수  
- 특정 계정에서 우선순위가 높은 모든 열린 사례의 가장 빠른 생성 시간  
  
각 롤업 필드는 *&lt;fieldname&gt;*`_date` 및 *&lt;fieldname&gt;*`_state` 접미사 패턴으로 두 개의 보조 필드를 만듭니다. `_date` 필드에는 DateTime 데이터가 포함되며, `_state` 필드에는 정수 데이터가 포함됩니다. `_state` 필드에는 다음 값이 있습니다.  
  
|값|상태|설명|  
|-|-|-|  
|0|NotCalculated|필드 값이 아직 계산되지 않았습니다.|  
|1|계산됨|_date 필드의 마지막 업데이트 시간에 따라 필드 값이 계산되었습니다.|  
|2|OverflowError|필드 값 계산 도중 오버플로 오류가 발생했습니다.|  
|3|OtherError|내부 오류로 필드 값 계산이 실패했습니다. 이 오류는 다음번 계산 작업 실행 시 해결될 가능성이 높습니다.|  
|4|RetryLimitExceeded|동시성 및 잠금 충돌이 많아서 값 계산을 시도할 수 있는 최대 횟수를 초과했기 때문에 필드 값 계산이 실패했습니다.|  
|5|HierarchicalRecursionLimitReached|계산의 최대 계층 구조 깊이 한도에 도달하여 필드 값 계산이 실패했습니다.|  
|6|LoopDetected|레코드의 계층 구조에서 재귀 루프가 발견되었기 때문에 필드 값 계산이 실패했습니다.|  
  
<a name="BKMK_calculations"></a>  
 
## <a name="rollup-calculations"></a>롤업 계산  

롤업은 백그라운드에서 비동기적으로 실행되는 예약된 시스템 작업으로 계산됩니다. 롤업 작업을 보고 관리하려면 관리자여야 합니다. 

### <a name="view-rollup-jobs"></a>롤업 작업 보기

롤업 작업을 보려면:

1. **Common Data Service 기본 솔루션**을 볼 때 URL을 편집하여 `dynamics.com` 다음에 오는 모든 것을 제거하고 페이지를 새로 고칩니다.
2. **설정** 영역에서 **시스템** > **시스템 작업**을 선택합니다.<br />![시스템 작업으로 이동](media/navigate-system-jobs.png)
1. 보기 선택기에서 **되풀이 시스템 작업**을 선택합니다.
2. 관련 작업을 빨리 찾으려면 **롤업 필드 대량 계산** 또는 **롤업 필드 계산**와 같은 시스템 작업 유형별로 필터링하면 됩니다.
 
### <a name="mass-calculate-rollup-field"></a>롤업 필드 대량 계산

**롤업 필드 대량 계산**은 롤업 필드에 따라 생성되는 되풀이 작업입니다. 사용자가 롤업 필드를 만들거나 업데이트한 후 한 번 실행됩니다. 이 작업은 이 필드를 포함하는 모든 기존 레코드에서 지정된 롤업 필드 값을 다시 계산합니다. 기본적으로 이 작업은 사용자가 필드를 만들거나 업데이트한 후 12시간 동안 실행됩니다. 작업이 완료되면 약 10년 후처럼 먼 미래에 실행되도록 자동으로 예약됩니다. 필드가 수정되면 업데이트 후 12시간 이내에 다시 실행되도록 작업이 재설정됩니다. **롤업 필드 대량 계산**이 사용 환경의 비작동 시간에 실행되도록 12시간의 지연 시간이 필요합니다. 관리자는 롤업 필드가 생성되거나 수정된 후 비작동 시간에 실행되도록 **롤업 필드 대량 계산** 작업의 시작 시간을 조정하는 것이 좋습니다. 예를 들어 롤업 필드의 효율적인 처리를 위해서는 자정에 작업을 실행하는 것이 좋습니다.  

### <a name="calculate-rollup-field"></a>롤업 필드 계산 

**롤업 필드 계산**은 지정된 엔터티의 기존 레코드에서 모든 롤업 필드의 증분 계산을 수행하는 되풀이 작업입니다. 엔터티당 **롤업 필드 계산** 작업은 하나뿐입니다. 증분 계산은 **롤업 필드 계산** 작업이 마지막 **롤업 필드 대량 계산** 작업 실행이 완료된 후 생성, 업데이트 또는 삭제된 레코드를 처리함을 의미합니다. 기본 최대 되풀이 설정은 1시간입니다. 이 작업은 엔터티의 첫 번째 롤업 필드가 생성될 때 생성되고, 마지막 롤업 필드가 삭제될 때 삭제됩니다.  

## <a name="online-recalculation-option"></a>온라인 재계산 옵션
양식의 롤업 필드를 마우스로 가리키면 마지막 롤업 시간을 볼 수 있으며, 아래 나와 있는 것처럼 필드 옆에 있는 새로 고침 아이콘을 선택하면 롤업 값을 새로 고칠 수 있습니다.  

![계정 양식의 롤업 필드](media/rollup-field-on-account-form.png)
  

온라인 재계산 옵션(양식의 수동 새로 고침)을 사용할 때 유의해야 하는 몇 가지 고려 사항이 있습니다.  
  
- 새로 고침을 요청하는 원본 레코드에 대한 쓰기 액세스 권한 및 엔터티에 대한 쓰기 권한이 있어야 합니다. 예를 들어 계정의 열린 기회에서 예상 수익을 계산하는 경우 기회 엔터티에 대한 쓰기 권한은 필요 없고, 계정 엔터티에 대한 쓰기 권한만 있으면 됩니다.  
- 이 옵션은 온라인 모드에서만 사용할 수 있습니다. 오프라인으로 작업할 때는 사용할 수 없습니다.  
- 롤업을 새로 고치는 동안 최대 레코드 수는 50,000개 레코드로 제한됩니다. 계층 구조 롤업의 경우 계층 구조 전체의 관련 레코드에 적용됩니다. 제한을 초과할 경우 *관련 레코드 50,000개라는 계산 한도에 도달하여 온라인으로 계산을 수행할 수 없습니다*라는 오류 메시지가 표시됩니다. 시스템 작업에서 롤업을 자동으로 다시 계산할 때는 이 제한이 적용되지 않습니다.  
- 원본 레코드의 최대 계층 구조 수준은 10으로 제한됩니다. 이 제한을 초과할 경우 *원본 코드의 계층 구조 수준 제한 10에 도달하여 온라인으로 계산을 수행할 수 없습니다*라는 오류 메시지가 표시됩니다. 시스템 작업에서 롤업을 자동으로 다시 계산할 때는 이 제한이 적용되지 않습니다.  

## <a name="modify-rollup-job-recurrence"></a>롤업 작업 되풀이 수정

시스템 관리자는 롤업 작업 되풀이 패턴을 수정하거나, 롤업 작업을 연기, 일시 중지 또는 재개할 수 있습니다. 그러나 롤업 작업을 취소하거나 삭제할 수는 없습니다. 

되풀이 패턴을 일시 중지, 연기, 다시 시작 또는 수정하려면 시스템 작업을 확인해야 합니다. 자세한 정보: [롤업 작업 보기](#view-rollup-jobs) 

탐색 모음에서 **작업**을 선택하고 원하는 동작을 선택합니다. 

**롤업 필드 대량 계산** 작업에 사용 가능한 옵션은 **다시 시작**, **연기** 및 **일시 중지**입니다. 

**롤업 필드 계산** 작업에 사용 가능한 옵션은 **되풀이 수정**, **다시 시작**, **연기** 및 **일시 중지**입니다.  
  
<a name="BKMK_businessscenarios"></a>  
 
## <a name="examples"></a>예 

롤업 필드의 예를 몇 가지 살펴보겠습니다. 계층 구조를 사용하거나 사용하지 않고 관련 레코드에서 레코드의 데이터를 집계하겠습니다. 또한 ActivityParty 엔터티를 통해 관련 활동과 레코드와 간접적으로 관련된 활동에서 레코드의 데이터를 집계하겠습니다. 각 예에서는 필드 편집기를 사용하여 롤업 필드를 정의합니다. 필드 편집기를 열려면 솔루션 탐색기를 열고 **구성 요소** > **엔터티**를 확장합니다. 원하는 엔터티를 선택하고 **필드**를 선택합니다. **새로 만들기**를 선택합니다. 편집기에서 **필드 유형** 및 **데이터 형식** 등 필드에 필요한 정보를 입력합니다. **필드 유형**에서 데이터 형식을 선택한 후 **롤업**을 선택합니다. 데이터 형식에는 10진수 또는 정수, 통화 및 날짜/시간이 포함됩니다. **필드 유형** 옆에 있는 **편집** 단추를 선택합니다. 그러면 롤업 필드 정의 편집기로 이동합니다. 롤업 필드 정의는 **원본 엔터티**, **관련 엔터티** 및 **집계**과 같은 세 가지 섹션으로 구성됩니다.  
  
-   **원본 엔터티** 섹션에서 롤업 필드가 정의된 엔터티와 계층 구조 전체를 집계할지 여부를 지정합니다. 여러 조건이 포함된 필터를 추가하여 롤업에 사용하려는 계층 구조의 레코드를 지정할 수 있습니다.  
  
-   **관련 엔터티** 섹션에서 집계를 수행하려는 엔터티를 지정합니다. 원본 엔터티의 계층 구조 전체에 롤업하도록 선택할 경우 이 섹션은 선택 사항입니다. 여러 조건이 포함된 필터를 추가하여 계산에 사용할 관련 레코드를 지정할 수 있습니다. 예를 들어, 연간 수익이 1000달러를 초과하는 열린 기회의 수익을 포함하세요.  
  
-   **집계** 섹션에서 계산하려는 메트릭을 지정합니다. SUM, COUNT, MIN, MAX 또는 AVG처럼 사용 가능한 집계 함수를 선택할 수 있습니다.  
  
### <a name="aggregate-data-for-a-record-from-related-records"></a>관련된 레코드의 레코드에 대한 데이터 집계  

이 예에서는 계층 구조가 사용되지 않습니다. 관련된 열린 기회에서 계정의 총 예상 수익이 계산됩니다.  

![계정의 예상 수익 집계](media/rollup-field-no-hierarchy.png)
  
### <a name="aggregate-data-for-a-record-from-the-child-records-over-the-hierarchy"></a>계층 구조 전체의 자식 레코드에서 레코드에 대한 데이터 집계 
 
이 예에서는 계층 구조 전체의 자식 기회를 포함한 기회의 총 예상 수익을 계산합니다.  
  
![예상 수익 집계, 기회 계층 구조](media/rollup-field-hierarchy-self.png)
  
### <a name="aggregate-data-for-a-record-from-the-related-records-over-the-hierarchy"></a>계층 구조 전체의 관련 레코드에서 레코드에 대한 데이터 집계

이 예에서는 계층 구조 전체의 모든 계정에서 열린 기회의 총 예상 수익을 계산합니다.  
  
![계정 계층 구조 전체의 예상 수익 집계](media/rollup-field-hierarchy.png)  
  
### <a name="aggregate-data-for-a-record-from-all-related-activities"></a>모든 관련 활동의 레코드에 대한 데이터 집계
  
이 예에서는 계정과 관련된 모든 활동에서 소요되고 청구된 총 시간을 계산합니다. 여기에는 휴대폰, 약속 또는 사용자 지정 작업에 소요된 시간이 포함될 수 있습니다.  
  
이전 릴리스에서는 전화 통화, 팩스 또는 약속과 같은 개별 활동에 대한 롤업 필드를 정의할 수 있었습니다. 하지만 아래 표시된 예제의 결과를 얻으려면 계산된 필드를 사용하여 데이터의 합계를 구해야 했습니다. 이제 활동 엔터티의 롤업 필드 하나를 정의하면 이러만 모든 작업을 한 번에 완료할 수 있습니다.  
  
![계정의 모든 활동 롤업](media/rollup-enhancements-activities.png)  
  
### <a name="aggregate-data-for-a-record-from-all-related-activities-and-activities-indirectly-related-via-the-activity-party-entity"></a>활동 주체 엔터티를 통해 모든 관련 활동과 간접적으로 관련된 활동에서 레코드의 데이터 집계  

이 예에서는 계정으로 전송된 총 이메일 수를 계수합니다. 여기서 계정은 이메일의 “받는 사람” 줄이나 “참조” 줄에 나와 있습니다. 이렇게 하려면 롤업 필드 정의에서 활동 주체 엔터티의 **필터**에 **참여 유형**을 지정합니다. 필터링을 사용하지 않으면 활동의 사용 가능한 모든 참여 유형이 계산에 사용됩니다. 
 
활동 주체 엔터티 및 특정 활동에 사용 가능한 참여 유형에 대한 자세한 내용은 [ActivityParty 엔터티](/dynamics365/customer-engagement/developer/activityparty-entity)를 참조하세요.

  
![롤업 관련 활동 및 활동 주체](media/rollup-enhancements-indirect-activities.png)  
  
### <a name="aggregate-data-for-a-record-from-related-records-using-the-avg-operator"></a>AVG 연산자를 사용한 관련 레코드의 레코드에 대한 데이터 집계

이 예에서는 특정 계정과 관련된 모든 기회의 평균 예상 수익을 계산합니다.  
  
![Dynamics 365의 평균 예상 수익](media/rollup-enhancements-average.PNG)  
  
다음 예에서는 계정의 계층 구조 전체에서 관련 기회의 평균 예상 수익을 계산하는 방법을 보여줍니다. 평균 예상 수익은 계층 구조의 각 수준에서 볼 수 있습니다.  
  
![Dynamics 365의 평균 예상 수익](media/cust-rollup-enhancements-avg-over-hierarchy.png)  
  
<a name="BKMK_considerations"></a> 

## <a name="rollup-field-considerations"></a>롤업 필드 고려 사항 

롤업 필드로 작업할 때는 특정 조건 및 제한 사항을 알고 있어야 합니다.  
  
- 조직에 최대 100개의 롤업 필드를 정의하고, 엔터티에 최대 10개의 롤업 필드를 정의할 수 있습니다.  
- 워크플로는 롤업 필드 업데이트로 트리거할 수 없습니다.  
- 워크플로 대기 조건은 롤업 필드를 사용할 수 없습니다.  
- 롤업 필드에 대한 롤업은 지원되지 않습니다.  
- 롤업은 다른 계산된 필드의 모든 필드가 현재 엔터티에 있더라도 다른 계산된 필드를 사용하는 계산된 필드를 참조할 수 없습니다.  
- 롤업은 원본 엔터티 또는 관련 엔터티, 간단한 필드 또는 복잡하지 않은 계산된 필드에만 필터를 적용할 수 없습니다.  
- 롤업은 1:N 관계가 있는 관련 엔터티에만 수행할 수 있습니다. N:N 관계에는 롤업을 수행할 수 없습니다.  
- 활동 엔터티 또는 활동 주체 엔터티의 1:N 관계에는 롤업을 수행할 수 없습니다.  
- 비즈니스 규칙, 워크플로 또는 계산된 필드는 항상 롤업 필드의 마지막 계산 값을 사용합니다.  
- 롤업 필드는 시스템 사용자 컨텍스트에서 집계됩니다. 모든 사용자는 동일한 롤업 필드 값을 확인할 수 있습니다. 롤업 필드에 액세스할 수 있는 사람을 제한하여 필드 수준 보안(FLS)으로 롤업 필드 표시 여부를 제어할 수 있습니다. 자세한 정보: [액세스를 제어하는 필드 수준 보안](/dynamics365/customer-engagement/admin/field-level-security) 

### <a name="precision-rounding"></a>전체 자릿수 반올림
 
집계된 필드의 전체 자릿수가 롤업 필드의 전체 자릿수보다 클 경우 집계를 수행하기 전에 집계된 필드의 전체 자릿수가 롤업 필드의 전체 자릿수로 반올림됩니다. 이 동작을 설명하기 위해 특정 예제를 살펴보겠습니다. 관련 기회의 총 예상 수익을 계산하기 위해 계정 엔터티의 롤업 필드에 소수점 둘째 자리의 전체 자릿수가 있다고 가정해 보겠습니다. 기회 엔터티의 예상 수익 필드는 소수점 넷째 자리의 전체 자릿수가 있는 집계된 필드입니다. 이 예에는 계정에 관련 기회가 두 개 있습니다. 예상 수익의 집계된 합계는 다음과 같이 계산됩니다.  
  
1. 첫 번째 기회의 예상 수익: 1000.0041달러  
1. 두 번째 기회의 예상 수익: 2000.0044달러  
1. 예상 수익의 집계된 합계: 1000.00달러 + 2000.00달러 = 3000.00달러

보시다시피, 집계가 수행되기 전에 집계된 필드의 소수점 둘째 자리까지 전체 자릿수가 반올림됩니다.  
  
### <a name="different-behavior-from-associated-grids"></a>연결된 그리드의 다른 동작
 
계정 또는 연락처와 같은 특정 엔터티 양식에는 기본적으로 연결된 그리드가 포함되어 있습니다. 예를 들어 계정 양식에는 연락처, 사례, 기회 및 기타 그리드가 포함됩니다. 계정 양식 그리드에 표시되는 레코드 중 일부는 계정 레코드와 직접적인 관련이 있고, 나머지 레코드는 다른 레코드와의 관계를 통해 간접적으로 관련되어 있습니다. 이에 비해 롤업 필드 집계는 롤업 필드 정의에 명시적으로 정의된 직접적인 관계만 사용합니다. 다른 관계는 고려되지 않습니다. 동작의 차이를 설명하기 위해 다음 예를 살펴보겠습니다.  
  
1. A1 계정에는 주 연락처 P1이 있습니다. 사례 C1은 계정 A1(C1.Customer 필드  =  A1)과 연결되어 있고, 사례 C2는 연락처 P1(C2.Customer 필드 = P1)과 연결되어 있습니다.  
1. A1 레코드에서 **계정** 양식의 **사례** 그리드는 C1과 C2라는 두 가지 사례를 보여줍니다.  
1. 총 사례 수라는 계정 엔터티의 롤업 필드는 계정과 연관된 사례를 계수하는 데 사용됩니다.  
1. 계정 롤업 필드 정의에 계정과 고객 관계인 사례를 지정합니다. 집계 후 총 사례 수는 1(사례 C1)과 동일합니다. C2 사례는 연락처와 직접적인 관련이 있고 계정과는 관련이 없으므로 합계에 포함되지 않으며, 계정 롤업 필드 정의에 명시적으로 정의될 수 없습니다. 따라서 롤업 작업에서 반환하는 총 사례 수는 **사례** 그리드에 표시되는 사례 수와 일치하지 않습니다.  
  
### <a name="see-also"></a>참고 항목  

[필드 만들기 및 편집](create-edit-fields.md)<br />
[계산된 필드 정의](define-calculated-fields.md)<br />
[날짜 및 시간 필드의 동작 및 형식](behavior-format-date-time-field.md)<br />
[계층적으로 관련된 데이터 정의 및 쿼리](define-query-hierarchical-data.md)<br />
[비디오: 롤업 및 계산된 필드](http://www.youtube.com/watch?v=RoahCH1p3T8&list=PLC3591A8FE4ADBE07&index=8)<br />
[비디오: Power BI 사용](http://www.youtube.com/watch?v=PkQe4BFlBS8&list=PLC3591A8FE4ADBE07&index=3)
