---
title: PowerApps에서 롤업 필드 정의 | MicrosoftDocs
description: 롤업 필드를 정의하는 방법 알아보기
ms.custom: ''
ms.date: 05/23/2018
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
  - Dynamics 365 (online)
  - Dynamics 365 Version 9.x
  - powerapps
author: Mattp123
ms.assetid: ff0504a1-01bd-4f9b-b884-7f84911d86c3
caps.latest.revision: 58
ms.author: matp
manager: kvivek
search.audienceType:
  - maker
search.app:
  - PowerApps
  - D365CE
---

# <a name="define-rollup-fields-that-aggregate-values"></a>값을 집계하는 롤업 필드 정의

롤업 필드는 사용자가 주요 비즈니스 메트릭을 모니터링하여 데이터에 대한 통찰력을 얻을 수 있도록 지원합니다. 롤업 필드는 지정된 레코드와 관련된 레코드를 통해 계산되는 누적 값을 포함합니다. 여기에는 전자 메일 및 약속과 같은 일반 엔터티와 활동 엔터티가 포함됩니다.

더 복잡한 시나리오에서는 레코드의 계층 구조를 통해 데이터를 집계할 수 있습니다. 관리자나 사용자 지정자는 코드를 작성할 개발자 필요 없이 PowerApps의 사용자 지정 도구를 사용하여 롤업 필드를 정의할 수 있습니다.  
  
<a name="BKMK_benefitsandcapabilities"></a> 
 
## <a name="rollup-fields-benefits-and-capabilities"></a>롤업 필드 이점 및 기능  

롤업 필드의 이점 및 기능에는 다음이 포함됩니다.  
  
- 시각적 편집은 간단합니다. 일반적인 필드를 만들 때 수행하는 것과 같이 필드 편집기를 사용하여 롤업 필드를 만들 수 있습니다.  
- 다양한 종류의 집계 함수입니다. `SUM`, `COUNT`, `MIN`, `MAX` 및 `AVG` 함수를 사용하여 데이터를 집계할 수 있습니다.  
- 집계에 대한 전체 필터 지원입니다. 여러 조건을 설정하는 동안 소스 엔터티 또는 관련 엔터티에 대한 다양한 필터를 설정할 수 있습니다.  
- 사용자 인터페이스와의 완벽한 통합입니다. 양식, 보기, 차트 및 보고서에 롤업 필드를 포함할 수 있습니다.  
- 롤업 필드는 솔루션 구성 요소입니다. 손쉽게 환경 간에 롤업 필드를 구성 요소로 전송하고 솔루션에 배포할 수 있습니다.  
- 롤업 필드 및 계산 필드는 상호 보완적입니다. 롤업 필드는 계산 필드의 일부로 사용하고 계산 필드는 롤업 필드의 일부로 사용할 수 있습니다.  
- 사용자 지정 컨트롤을 사용하도록 롤업 필드를 구성할 수 있습니다.  
  
 롤업 필드의 몇 가지 예는 다음과 같습니다.  
  
- 거래처 열린 영업 기회의 총 예상 수익  
- 계층 구조의 모든 거래처에서 열린 영업 기회의 총 예상 수익  
- 하위 영업 기회를 포함하여 영업 기회의 총 예상 수익  
- 캠페인에 의해 생성된 우량 잠재 고객의 총 예상 가치  
- 계층 구조의 모든 거래처에서 우선 순위가 높은 열린 케이스의 수  
- 거래처에 대해 모든 우선 순위가 높은 열린 케이스의 가장 빨리 만들어진 시간  
  
각 롤업 필드는 *&lt;fieldname&gt;*`_date` 및 *&lt;fieldname&gt;*`_state` 접미사 패턴이 있는 두 액세서리 필드를 만듭니다. `_date` 필드에는 DateTime 데이터가 포함되고 `_state` 필드에는 정수 데이터가 포함됩니다. `_state` 필드에는 다음 값이 있습니다.  
  
|값|상태|설명|  
|-|-|-|  
|0|NotCalculated|필드 값이 계산됩니다.|  
|1|Calculated|필드 값이 _date 필드에서 마지막 업데이트 시간에 계산되었습니다.|  
|2|OverflowError|필드 값 계산이 오버플로 오류로 인한 것입니다.|  
|3|OtherError|내부 오류로 인해 필드 값을 계산하지 못했습니다. 계산 작업의 다음 실행은 이를 해결할 가능성이 있습니다.|  
|4|RetryLimitExceeded|많은 수의 동시성과 잠금 충돌로 인해 값을 계산하는 다시 시도의 최대 횟수를 초과했기 때문에 필드 값 계산에 실패했습니다.|  
|5|HierarchicalRecursionLimitReached|계산에 대한 최대 계층 구조 깊이 제한에 도달했기 때문에 필드 값 계산에 실패했습니다.|  
|6|LoopDetected|레코드의 계층 구조에서 재귀 루프가 감지되었기 때문에 필드 값 계산에 실패했습니다.|  
  
<a name="BKMK_calculations"></a>  
 
## <a name="rollup-calculations"></a>롤업 계산  

롤업은 백그라운드에서 비동기적으로 실행되는 예약된 시스템 작업에 의해 계산됩니다. 관리자는 롤업 작업을 보고 관리해야 합니다. 

### <a name="view-rollup-jobs"></a>롤업 작업 보기

롤업 작업을 보려면

1. **Common Data Services 기본 솔루션**을 보는 동안 `dynamics.com` 후 모든 것을 제거하고 URL을 편집하고 페이지를 새로 고칩니다.
2. **설정** 영역에서 **시스템**  > **시스템 작업**을 선택합니다.<br />![시스템 작업으로 이동](media/navigate-system-jobs.png)
1. 보기 선택기에서 **되풀이 시스템 작업**을 선택합니다.
2. 관련 작업을 신속하게 찾으려면 **롤업 필드 대량 계산** 또는 **롤업 필드 계산** 등 시스템 작업 유형으로 필터링할 수 있습니다.
 
### <a name="mass-calculate-rollup-field"></a>롤업 필드 대량 계산

**롤업 필드 대량 계산**은 되풀이하는 작업으로 롤업 필드마다 만들어집니다. 롤업 필드를 만들거나 업데이트한 후에는 한 번 실행됩니다. 작업은 이 필드를 포함하는 모든 기존 레코드에서 지정된 롤업 필드 값을 다시 계산합니다. 기본적으로 작업은 필드를 만들거나 업데이트하고 12시간 후에 실행됩니다. 작업이 완료된 후 먼 미래(약 10년)에 실행하도록 자동으로 예약됩니다. 필드가 수정된 경우 작업은 업데이트 후 12시간 내에 다시 실행하도록 다시 설정됩니다. 환경이 영업하지 않는 시간 동안 **롤업 필드 대량 계산**이 실행되도록 12시간 지연이 필요합니다. 관리자는 영업 시간 이외에 실행되도록 롤업 필드를 만들거나 수정한 후 **롤업 필드 대량 계산 작업**의 시작 시간을 조정하는 것이 좋습니다. 예를 들어, 롤업 필드를 효율적으로 처리할 수 있도록 자정에 작업을 실행하는 것이 좋습니다.  

### <a name="calculate-rollup-field"></a>롤업 필드 계산 

**롤업 필드 계산**은 지정된 엔터티에 대한 기존 레코드에서 모든 롤업 필드의 증분 계산을 수행하는 되풀이하는 작업입니다. 엔터티당 **롤업 필드 계산** 작업은 하나만 있습니다. 증분 계산이란 **롤업 필드 계산** 작업이 마지막 **롤업 필드 대량 계산** 작업 실행을 완료한 후 만들어지거나 업데이트되거나 삭제된 레코드를 처리하는 것입니다. 기본 최대 되풀이 설정은 1시간입니다. 마지막 롤업 필드가 삭제되었을 때 엔터티에 대한 첫 번째 롤업 필드가 만들어지고 삭제될 때 작업은 자동으로 만들어집니다.  

## <a name="online-recalculation-option"></a>온라인 계산 옵션입니다.
양식에서 롤업 필드 위로 커서를 가져가면 마지막 롤업 시간을 볼 수 있으며 아래 그림처럼 필드 옆의 새로 고침 아이콘을 선택하여 롤업 값을 새로 고칠 수 있습니다.  

![계정 양식의 롤업 필드](media/rollup-field-on-account-form.png)
  

온라인 다시 계산 옵션을 사용할 때 염두에 두어야 하는 몇 가지 고려 사항이 있습니다(양식에서 수동으로 새로 고침).  
  
- 엔터티에 대한 쓰기 권한과 새로 고침을 요청하는 원본 레코드에 대한 쓰기 액세스 권한이 있어야 합니다. 예를 들어, 거래처의 열린 영업 기회에서 예상 수익을 계산하는 경우 영업 기회 엔터티에 대한 쓰기 권한은 필요 없고 거래처 엔터티에 대한 쓰기 권한만 필요합니다.  
- 이 옵션은 온라인 모드에서만 사용할 수 있습니다. 오프라인으로 작업하는 동안에는 사용할 수 없습니다.  
- 롤업 새로 고침 동안 레코드의 최대 개수는 50,000 레코드로 제한됩니다. 계층적 롤업의 경우 이는 계층 구조의 관련 레코드에 적용됩니다. 제한을 초과하는 경우 *50,000개의 관련 레코드의 계산 한도에 도달하여 온라인으로 계산을 수행할 수 없습니다.* 라는 오류 메시지가 표시됩니다. 이 제한은 시스템 작업에 의해 롤업이 자동으로 다시 계산될 때는 적용되지 않습니다.  
- 소스 레코드에 대한 최대 계층 구조 깊이는 10으로 제한됩니다. 제한을 초과하는 경우 *소스 레코드 10개에 대한 계층 구조 깊이 한도에 도달하여 온라인으로 계산을 수행할 수 없습니다.* 라는 오류 메시지가 표시됩니다. 이 제한은 시스템 작업에 의해 롤업이 자동으로 다시 계산될 때는 적용되지 않습니다.  

## <a name="modify-rollup-job-recurrence"></a>롤업 작업 되풀이 수정

시스템 관리자는 롤업 작업 되풀이 패턴을 수정하고 롤업 작업을 연기, 일시 중지 또는 다시 시작할 수 있습니다. 그러나 롤업 작업을 취소하거나 삭제할 수는 없습니다. 

되풀이 패턴을 일시 중지, 연기, 다시 시작 또는 수정하려면 시스템 작업을 보아야 합니다. 자세한 정보 [롤업 작업 보기](#view-rollup-jobs) 

탐색 모음에서 **작업**을 선택하고 원하는 작업을 선택합니다. 

**롤업 필드 대량 계산** 작업의 경우 **다시 시작**, **연기** 및 **일시 중지**를 선택할 수 있습니다. 

**롤업 필드 계산** 작업의 경우 **되풀이 수정**, **다시 시작**, **연기** 및 **일시 중지**를 선택할 수 있습니다.  
  
<a name="BKMK_businessscenarios"></a>  
 
## <a name="examples"></a>예제 

롤업 필드 예 몇 가지를 살펴보겠습니다. 계층 구조를 사용하거나 사용하지 않고 관련 레코드의 레코드에 대한 데이터를 집계합니다. 관련된 활동 및 ActivityParty 엔터티를 통해 레코드와 간접적으로 관련된 활동에 대한 데이터도 집계합니다. 각 예제에서 필드 편집기를 사용하여 롤업 필드를 정의합니다. 필드 편집기를 열려면 솔루션 탐색기를 열고 **구성 요소** > **엔터티**를 확장합니다. 원하는 엔터티를 선택하고 **필드**를 선택합니다. **새로 만들기**를 선택합니다. 편집기에서 **필드 형식** 및 **데이터 형식**을 포함한 필드에 필요한 정보를 제공합니다. **필드 형식**에서 데이터 형식을 선택한 후 **롤업**을 선택합니다. 데이터 형식은 실수 또는 정수, 통화 및 날짜/시간을 포함합니다. **필드 유형** 옆의 **편집** 단추를 선택합니다. 그러면 롤업 필드 정의 편집기로 이동합니다. 롤업 필드 정의는 **소스 엔터티**, **관련 엔터티** 및 **집계**의 세 섹션으로 구성됩니다.  
  
-   **소스 엔터티** 섹션에서 롤업 필드가 정의된 엔터티 및 계층 구조에서 집계할지 여부를 지정합니다. 롤업에 사용하려는 계층 구조에서 레코드를 지정하기 위해 여러 조건을 갖는 필터를 추가할 수 있습니다.  
  
-   **관련 엔터티** 섹션에서는 집계하는 엔터티를 지정합니다. 이 섹션은 원본 엔터티의 계층 구조에 대한 롤업을 선택할 경우 선택 사항입니다. 계산에서 사용할 관련 레코드를 지정하기 위해 여러 조건을 갖는 필터를 추가할 수 있습니다. 예를 들어, 연간 수익이 $1000 이상인 열린 영업 기회의 수익을 포함합니다.  
  
-   **집계** 섹션에서 계산하려는 메트릭을 지정합니다. SUM, COUNT, MIN, MAX 또는 AVG 같은 사용 가능한 집계 함수를 선택할 수 있습니다.  
  
### <a name="aggregate-data-for-a-record-from-related-records"></a>관련 레코드의 레코드에 대한 데이터 집계  

이 예제에서는 계층 구조가 사용되지 않습니다. 총 예상 수익은 관련된 열린 영업 기회의 계정에 대해 계산됩니다.  

![계정에 대한 예상 수익 집계](media/rollup-field-no-hierarchy.png)
  
### <a name="aggregate-data-for-a-record-from-the-child-records-over-the-hierarchy"></a>계층 구조를 통해 하위 레코드의 레코드에 대한 데이터 집계 
 
이 예제에서는 계층 구조에서 하위 영업 구조를 포함하는 영업 기회의 총 예상 수익을 계산합니다.  
  
![예상 수익 집계, 영업 기회 계층 구조](media/rollup-field-hierarchy-self.png)
  
### <a name="aggregate-data-for-a-record-from-the-related-records-over-the-hierarchy"></a>계층 구조를 통해 관련 레코드의 레코드에 대한 데이터 집계

이 예제에서는 계층 구조에서 모든 거래처의 열린 영업 구조의 총 예상 수익을 계산합니다.  
  
![계정 계층 구조에 대한 예상 수익 집계](media/rollup-field-hierarchy.png)  
  
### <a name="aggregate-data-for-a-record-from-all-related-activities"></a>모든 관련 활동 레코드에 대한 데이터 집계
  
이 예제에서는 거래처와 관련된 모든 활동에서 사용하고 청구되는 총 시간을 계산합니다. 여기에는 전화, 약속 또는 사용자 지정 활동에 소비한 시간을 포함할 수 있습니다.  
  
이전 릴리스에서는 전화 통화, 팩스 또는 약속 같은 개별 활동에 대한 롤업 필드를 정의할 수 있었습니다. 하지만 아래 표시된 예제의 결과를 얻으려면 계산 필드를 사용하여 데이터를 합계해야 했습니다. 이제는 활동 엔터티에 대해 한 롤업 필드를 정의하여 한 단계에 모든 작업을 수행할 수 있습니다.  
  
![계정에 대한 모든 활동 롤업](media/rollup-enhancements-activities.png)  
  
### <a name="aggregate-data-for-a-record-from-all-related-activities-and-activities-indirectly-related-via-the-activity-party-entity"></a>모든 관련된 활동 및 활동 당사자 엔터티를 통해 간접적으로 관련된 활동의 레코드에 대한 데이터를 집계합니다.  

이 예제에서는 거래처에 전송된 전자 메일의 총 수를 계산합니다. 여기서 거래처는 전자 메일 “받는 사람” 줄과 “참조" 줄에 나열됩니다. 롤업 필드 정의의 활동 당사자 엔터티에 대해 **필터**에 **참여 유형**을 지정하여 수행됩니다. 필터링을 사용하지 않으면 활동에 대해 사용 가능한 모든 참여 유형이 계산에 사용됩니다. 
 
특정 활동에 사용할 수 있는 활동 당사자 엔터티와 참여 유형에 대한 자세한 내용은 [ActivityParty 엔터티](/dynamics365/customer-engagement/developer/activityparty-entity)를 참조하십시오.

  
![롤업 관련 활동과 활동 당사자](media/rollup-enhancements-indirect-activities.png)  
  
### <a name="aggregate-data-for-a-record-from-related-records-using-the-avg-operator"></a>AVG 연산자를 사용하여 관련 레코드의 레코드에 대한 데이터 집계

이 예제에서는 거래처와 관련된 모든 영업 기회에서 예상되는 평균 매출을 계산합니다.  
  
![Dynamics 365의 평균 예상 수익](media/rollup-enhancements-average.PNG)  
  
다음 예제에서는 거래처의 계층 구조를 통해 관련 영업 기회의 평균 예상 매출을 계산하는 방법을 보여줍니다. 평균 예상 매출은 계층 구조의 각 수준에서 볼 수 있습니다.  
  
![Dynamics 365의 평균 예상 수익](media/cust-rollup-enhancements-avg-over-hierarchy.png)  
  
<a name="BKMK_considerations"></a> 

## <a name="rollup-field-considerations"></a>롤업 필드 고려 사항 

롤업 필드를 작업할 때 특정 조건과 제한 사항을 알고 있어야 합니다.  
  
- 조직에 대해 최대 100개의 롤업 필드와 엔터티당 최대 10개의 롤업 필드를 정의할 수 있습니다.  
- 워크플로는 롤업 필드 업데이트에 의해 트리거될 수 없습니다.  
- 워크플로 대기 조건은 롤업 필드를 사용할 수 없습니다.  
- 롤업 필드에 대한 롤업은 지원되지 않습니다.  
- 롤업은 다른 계산 필드의 모든 필드가 현재 엔터티인 경우에도 다른 계산 필드를 사용하는 계산 필드를 참조할 수 없습니다.  
- 롤업은 소스 엔터티나 관련 엔터티, 단순 필드 또는 복잡하지 않은 계산 필드에만 필터를 적용할 수 있습니다.  
- 롤업은 1:N 관계를 갖는 관련 엔터티에 대해서만 수행할 수 있습니다. 롤업은 N:N 관계에서는 수행할 수 없습니다.  
- 롤업은 활동 엔터티 또는 활동 당사자 엔터티의 경우 1:N 관계에서는 수행할 수 없습니다.  
- 비즈니스 규칙, 워크플로 또는 계산 필드는 항상 롤업 필드의 마지막 계산 값을 사용합니다.  
- 롤업 필드는 시스템 사용자 컨텍스트 아래 집계됩니다. 모든 사용자는 같은 롤업 필드 값을 볼 수 있습니다. 롤업 필드에 액세스할 수 있는 사용자를 제한함으로써 필드 수준 보안(FLS)으로 롤업 필드 가시성을 제어할 수 있습니다. 추가 정보  [액세스 제어를 위한 필드 수준 보안](/dynamics365/customer-engagement/admin/field-level-security) 

### <a name="precision-rounding"></a>정밀도 반올림
 
집계 필드의 정밀도가 롤업 필드의 정밀도보다 큰 경우 집계된 필드 정밀도는 집계를 수행하기 전에 롤업 필드의 정밀도로 반올림하여 내려집니다. 이 동작을 보여주기 위해 특정한 예를 살펴 보겠습니다. 관련 영업 기회의 총 예상 매출을 계산하기 위해 계정 엔터티의 롤업 필드의 정밀도는 소수점 이하 2자리입니다. 예상치 영업 기회 엔터티에 있는 예상 매출 필드는 정밀도가 소수점 이하 4자리인 집계 필드입니다. 이 예에서 계정에는 두 개의 관련 영업 기회가 있습니다. 예상 매출의 집계된 합계는 다음과 같이 계산됩니다.  
  
1. 예상 첫 번째 영업 기회의 예상 매출: $1000.0041  
1. 예상 두 번째 영업 기회의 예상 매출: $2000.0044  
1. 집계된 총 예상치 수익: $1000.00 + $2000.00 = $3000.00

알다시피 집계된 필드에서 소수점 이하 2자리로 반올림하는 정밀도는 집계를 수행하기 전에 수행됩니다.  
  
### <a name="different-behavior-from-associated-grids"></a>연결 된 표에서 다른 동작
 
기본 제공되는 거래처 또는 연락처 같은 특정 엔터티 양식에는 관련 표가 포함되어 있습니다. 예를 들어, 거래처 양식에는 연락처, 케이스, 영업 기회 및 기타 표가 포함되어 있습니다. 거래처 양식에 표시되는 일부 레코드는 계정 레코드와 직접 관련이 있으며, 다른 레코드는 다른 레코드와의 관례를 통해 간접적으로 관련이 있습니다. 비교할 때 롤업 필드 집계는 롤업 필드 정의에 명시적으로 정의된 직접 관계만 사용합니다. 다른 관계는 없는 것으로 간주됩니다. 동작의 차이를 보여주기 위해 다음 예제를 살펴 보겠습니다.  
  
1. 계정 A1에는 기본 연락처 P1이 있습니다. 케이스 C1은 계정 A1(C1.Customer 필드 = A1)과 연관되었고 케이스 C2는 연락처 P1(C2.Customer 필드 = P1)와 연관되어 있습니다.  
1. A1 레코드에 대한 **거래처** 양식의 **케이스** 표는 두 케이스 C1 및 C2를 보여줍니다.  
1. 총 서비스 케이스 수라고 하는 계정 엔터티에 있는 롤업 필드는 계정과 연관된 케이스 수를 세는 데 사용됩니다.  
1. 계정 롤업 필드 정의에서는 거래처와 고객 관계가 있는 케이스를 지정합니다. 집계 후에 총 서비스 케이스 수는 1(케이스 C1)과 같습니다. 케이스 C2는 거래처가 아닌 연락처와 직접 관련이 있으므로 합계에 포함되지 않으며 거래처 롤업 필드 정의에 명시적으로 정의될 수 없습니다. 결과적으로 롤업 작업에서 반환되는 총 케이스 수는 **케이스** 표에 표시된 케이스 수와 일치하지 않습니다.  
  
### <a name="see-also"></a>참조  

[필드 만들기 및 편집](create-edit-fields.md)<br />
[계산된 필드 정의](define-calculated-fields.md)<br />
[날짜 및 시간 필드의 특성 및 형식](behavior-format-date-time-field.md)<br />
[계층적으로 관련된 데이터를 정의하고 쿼리하기](define-query-hierarchical-data.md)<br />
[비디오: 롤업 및 계산 필드](http://www.youtube.com/watch?v=RoahCH1p3T8&list=PLC3591A8FE4ADBE07&index=8)<br />
[비디오: Power BI 사용](http://www.youtube.com/watch?v=PkQe4BFlBS8&list=PLC3591A8FE4ADBE07&index=3)
